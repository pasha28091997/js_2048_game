var t,e={};const s=new((t=class{constructor(t){this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}createEmptyBoard(){return[,,,,].fill().map(()=>[,,,,].fill(0))}moveLeft(){let t=!1;for(let e of this.board){let s=this.merge(this.slide(e));this.arraysEqual(e,s)||(t=!0),Object.assign(e,s)}t&&this.addRandomTile()}moveRight(){let t=!1;for(let e of this.board){let s=e.slice().reverse(),r=this.merge(this.slide(s)).reverse();this.arraysEqual(e,r)||(t=!0,Object.assign(e,r))}t&&this.addRandomTile()}moveUp(){let t=!1;for(let e=0;e<4;e++){let s=this.getColumn(e),r=this.merge(this.slide(s));this.arraysEqual(s,r)||(t=!0,this.setColumn(e,r))}t&&this.addRandomTile()}moveDown(){let t=!1;for(let e=0;e<4;e++){let s=this.getColumn(e).reverse(),r=this.merge(this.slide(s)).reverse();this.arraysEqual(s,r)||(t=!0,this.setColumn(e,r))}t&&this.addRandomTile()}getColumn(t){let e=[];for(let s=0;s<4;s++)e.push(this.board[s][t]);return e}setColumn(t,e){for(let s=0;s<4;s++)this.board[s][t]=e[s]}slide(t){let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);return e}merge(t){for(let e=0;e<t.length-1;e++)0!==t[e]&&t[e]===t[e+1]&&(t[e]*=2,t[e+1]=0,this.score+=t[e]);return this.slide(t)}arraysEqual(t,e){return t.length===e.length&&t.every((t,s)=>t===e[s])}getScore(){return this.score}getState(){return this.board}getStatus(){return this.board.some(t=>t.includes(2048))?"win":this.board.some((t,e)=>t.some((s,r)=>0===s||r<3&&s===t[r+1]||e<3&&s===this.board[e+1][r]))?"playing":"lose"}start(){"idle"===this.status&&(this.status="playing",this.addRandomTile(),this.addRandomTile())}restart(){this.board=this.createEmptyBoard(),this.score=0,this.status="idle",this.start()}addRandomTile(){let t=[];for(let e=0;e<this.board.length;e++)for(let s=0;s<this.board[e].length;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let{row:e,col:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}}).__esModule?t.default:t);let r=!1;function l(){let t=s.getState(),e=s.getScore(),r=s.getStatus();document.querySelector(".game-score").textContent=e;let l=document.querySelectorAll(".field-cell"),o=0;for(let e of t)for(let t of e){let e=l[o];e.className="field-cell",0!==t?(e.classList.add(`field-cell--${t}`),e.textContent=t):e.textContent="",o++}document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-lose").classList.toggle("hidden","lose"!==r),document.querySelector(".message-win").classList.toggle("hidden","win"!==r);let a=document.querySelector(".button.start");"idle"===r?(a.textContent="Start",a.classList.remove("restart")):(a.textContent="Restart",a.classList.add("restart"))}document.addEventListener("keydown",t=>{if(r&&"playing"===s.getStatus()){switch(t.key){case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight();break;case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown();break;default:return}l()}}),document.querySelector(".button.start").addEventListener("click",()=>{"idle"===s.getStatus()?s.start():s.restart(),r=!0,l()});
//# sourceMappingURL=index.82f120ac.js.map
